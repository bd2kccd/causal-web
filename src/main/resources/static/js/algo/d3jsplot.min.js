
function plotGraph(c){var r={};var v=window.innerWidth-40;var e=window.innerHeight-40;var x=6;var s=0;var h={};var y=0.1;c.forEach(function(z){z.source=r[z.source]||(r[z.source]={name:z.source});z.target=r[z.target]||(r[z.target]={name:z.target})});var r=Object.keys(r).map(function(z){return r[z]});var b=d3.zoom().scaleExtent([0.2,10]).on("zoom",n);var o=d3.select("#causal-graph").append("svg").attr("width",v).attr("height",e).call(b).on("dblclick.zoom",null);var a=o.append("g");var j=d3.forceSimulation(r).force("link",d3.forceLink().id(function(z){return z.index})).force("charge",d3.forceManyBody()).force("collide",d3.forceCollide(2)).force("center",d3.forceCenter(v/2,e/2)).on("tick",g);j.force("link").links(c);j.force("link").distance(50);for(i=0;i<r.length;i++){h[i+","+i]=1}c.forEach(function(z){h[z.source.index+","+z.target.index]=1});a.append("defs").append("marker").attr("id","marker-start-arrow").attr("viewBox","0 -5 10 10").attr("refX",-10).attr("refY",0).attr("markerWidth",x).attr("markerHeight",x).attr("orient","auto").append("path").attr("d","M10,-5L0,0L10,5").attr("class","marker-start-arrow");a.append("defs").append("marker").attr("id","marker-start-circle").attr("viewBox","0 -5 10 10").attr("refX",-8).attr("refY",0).attr("markerWidth",x).attr("markerHeight",x).attr("orient","auto").append("circle").attr("cx",6).attr("cy",0).attr("r",4).attr("class","marker-start-circle");a.append("defs").append("marker").attr("id","marker-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",x).attr("markerHeight",x).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","marker-end-arrow");a.append("defs").append("marker").attr("id","marker-end-circle").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",x).attr("markerHeight",x).attr("orient","auto").append("circle").attr("cx",6).attr("cy",0).attr("r",4).attr("class","marker-end-circle");var k=a.append("g").selectAll(".link").data(c).enter().append("path").attr("class","link").attr("marker-start",function(z){if(z.type==="<->"){return"url(#marker-start-arrow)"}else{if(z.type==="o-o"||z.type==="o->"){return"url(#marker-start-circle)"}else{return""}}}).attr("marker-end",function(z){if(z.type==="-->"||z.type==="<->"||z.type==="o->"){return"url(#marker-end-arrow)"}else{if(z.type==="o-o"){return"url(#marker-end-circle)"}else{return""}}}).style("stroke",function(z){if(z.edgeProps!==null&&z.edgeProps.indexOf("dd")>=0){return d3.rgb(0,128,0)}}).style("stroke-dasharray",function(z){if(z.edgeProps!==null&&z.edgeProps.indexOf("nl")>=0){return(6,3)}});var t=a.append("g").selectAll(".node").data(r).enter().append("circle").attr("class","node").attr("r",x).on("dblclick",u).call(d3.drag().on("start",p).on("drag",l).on("end",q));var m=a.append("g").selectAll(".node-name").data(r).enter().append("text").attr("class","node-name").attr("x",8).attr("y",".31em").text(function(z){return z.name});function g(){t.attr("cx",function(z){return z.x}).attr("cy",function(z){return z.y});k.attr("d",f).each(function(){this.parentNode.insertBefore(this,this)});m.attr("x",function(z){return z.x+x}).attr("y",function(z){return z.y+x/2})}function f(z){return"M"+z.source.x+","+z.source.y+"L"+z.target.x+","+z.target.y}function n(){a.attr("transform",d3.event.transform)}function w(A,z){return h[A.index+","+z.index]}function u(){if(s===0){d=d3.select(this).node().__data__;t.style("opacity",function(z){return w(d,z)|w(z,d)?1:y});m.style("opacity",function(z){return w(d,z)|w(z,d)?1:y});k.style("opacity",function(z){return d.index===z.source.index|d.index===z.target.index?1:y});s=1}else{t.style("opacity",1);m.style("opacity",1);k.style("opacity",1);s=0}}function p(){if(!d3.event.active){j.alphaTarget(0.3).restart()}d3.event.subject.fx=d3.event.subject.x;d3.event.subject.fy=d3.event.subject.y}function l(){d3.event.subject.fx=d3.event.x;d3.event.subject.fy=d3.event.y}function q(){if(!d3.event.active){j.alphaTarget(0)}d3.event.subject.fx=null;d3.event.subject.fy=null}$("#searchBtn").click(function(){var C=$("#search").val();var B=a.selectAll(".node");if(C===""){B.style("stroke","white").style("stroke-width","1")}else{var z=B.filter(function(E,D){return E.name.toLowerCase()!==C.toLowerCase()});z.style("opacity","0");var A=a.selectAll(".link");A.style("opacity","0");d3.selectAll(".node, .link").transition().duration(5000).style("opacity",1)}})};